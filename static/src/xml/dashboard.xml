<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-name="lms.Dashboard" owl="1">
        <div class="lms-dashboard-container">

            <aside class="lms-sidebar">
                <div class="lms-logo">ðŸšš Logistics Management</div>

                <ul class="lms-menu">
                    <li t-on-click="() => setActiveSection('dashboard')" t-att-class="{'active': state.tab === 'dashboard'}">
            Dashboard Overview
                    </li>

                    <li t-if="hasAccess('lead')" t-on-click="() => setActiveSection('lead')" t-att-class="{'active': state.tab === 'lead'}">
            Lead Management
                    </li>

                    <li t-if="hasAccess('warehouse')" t-on-click="() => setActiveSection('warehouse')" t-att-class="{'active': state.tab === 'warehouse'}">
            Warehouse Management
                    </li>

                    <li t-if="hasMenuAccess('dispatch')">
                        <div t-on-click="() => toggleSubMenu('dispatch')" class="menu-header">
                            <span>Dispatch Management</span>
                            <span class="arrow" t-esc="state.expanded.dispatch ? 'â–¾' : 'â–¸'"/>
                        </div>
                        <ul t-if="state.expanded.dispatch" class="submenu">
                            <li t-if="hasAccess('trip_sheet')" t-on-click="() => setActiveSection('trip_sheet')">Trip Sheet</li>
                            <li t-if="hasAccess('route_dispatch')" t-on-click="() => setActiveSection('route_dispatch')">Route Dispatch</li>
                            <li t-if="hasAccess('lr')" t-on-click="() => setActiveSection('lr')">Lorry Receipt (LR)</li>
                            <li t-if="hasAccess('pod')" t-on-click="() => setActiveSection('pod')">Proof of Delivery (POD)</li>
                            <li t-if="hasAccess('ewaybill')" t-on-click="() => setActiveSection('ewaybill')">E-Way Bill</li>
                        </ul>
                    </li>

                    <li t-if="hasMenuAccess('operations')">
                        <div t-on-click="() => toggleSubMenu('operations')" class="menu-header">
                            <span>Logistics Operations</span>
                            <span class="arrow" t-esc="state.expanded.operations ? 'â–¾' : 'â–¸'"/>
                        </div>
                        <ul t-if="state.expanded.operations" class="submenu">
                            <li t-if="hasAccess('fleet_overview')" t-on-click="() => setActiveSection('fleet_overview')">Fleet Overview</li>
                            <li t-if="hasAccess('vehicle_costs')" t-on-click="() => setActiveSection('vehicle_costs')">Vehicle Costs</li>
                            <li t-if="hasAccess('odoometer')" t-on-click="() => setActiveSection('odoometer')">Odometer</li>
                            <li t-if="hasAccess('route_optimization')" t-on-click="() => setActiveSection('route_optimization')">Route Optimization</li>
                        </ul>
                    </li>

                    <li t-if="hasMenuAccess('finance')">
                        <div t-on-click="() => toggleSubMenu('finance')" class="menu-header">
                            <span>Finance &amp; Accounting</span>
                            <span class="arrow" t-esc="state.expanded.finance ? 'â–¾' : 'â–¸'"/>
                        </div>
                        <ul t-if="state.expanded.finance" class="submenu">
                            <li t-if="hasAccess('finance_overview')" t-on-click="() => setActiveSection('finance_overview')">Overview</li>
                            <li t-if="hasAccess('customer_invoices')" t-on-click="() => setActiveSection('customer_invoices')">Customer Invoices</li>
                            <li t-if="hasAccess('customer_credit_notes')" t-on-click="() => setActiveSection('customer_credit_notes')">Customer Credit Notes</li>
                            <li t-if="hasAccess('customer_payments')" t-on-click="() => setActiveSection('customer_payments')">Customer Payments</li>
                            <li t-if="hasAccess('accounting_journals')" t-on-click="() => setActiveSection('accounting_journals')">Accounting Journals</li>
                            <li t-if="hasAccess('accounting_journals_entries')" t-on-click="() => setActiveSection('accounting_journals_entries')">Journal Entries</li>
                            <li t-if="hasAccess('vendor_payments')" t-on-click="() => setActiveSection('vendor_payments')">Bills</li>
                        </ul>
                    </li>

                    <li t-if="hasAccess('rfq')" t-on-click="() => setActiveSection('rfq')" t-att-class="{'active': state.tab === 'rfq'}">
            RFP/RFQ
                    </li>

                    <li t-if="hasMenuAccess('reporting')">
                        <div t-on-click="() => toggleSubMenu('reporting')" class="menu-header">
                            <span>Reporting</span>
                            <span class="arrow" t-esc="state.expanded.reporting ? 'â–¾' : 'â–¸'"/>
                        </div>
                        <ul t-if="state.expanded.reporting" class="submenu">
                            <li t-if="state.userRole === 'manager'">
                                <div t-on-click="() => toggleSubMenu('sales_reporting')" class="menu-header submenu-header">
                                    <span>Sales</span>
                                    <span class="arrow" t-esc="state.expanded.sales_reporting ? 'â–¾' : 'â–¸'"/>
                                </div>
                                <ul t-if="state.expanded.sales_reporting" class="submenu nested">
                                    <li t-on-click="() => setActiveSection('sales')">Lead Sales</li>
                                    <li t-on-click="() => setActiveSection('sales_persons')">Sales Persons</li>
                                    <li t-on-click="() => setActiveSection('sales_products')">Products</li>
                                </ul>
                            </li>

                            <li>
                                <div t-on-click="() => toggleSubMenu('inventory_warehouse_reporting')" class="menu-header submenu-header">
                                    <span>Inventory &amp; Warehouse</span>
                                    <span class="arrow" t-esc="state.expanded.inventory_warehouse_reporting ? 'â–¾' : 'â–¸'"/>
                                </div>
                                <ul t-if="state.expanded.inventory_warehouse_reporting" class="submenu nested">
                                    <li t-if="hasAccess('overview')" t-on-click="() => setActiveSection('overview')">Overview</li>
                                    <li t-if="hasAccess('warehouse_analysis')" t-on-click="() => setActiveSection('warehouse_analysis')">Warehouse Analysis</li>
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li t-if="hasAccess('contract')" t-on-click="() => setActiveSection('contract')" t-att-class="{'active': state.tab === 'contract'}">
            Contract Management
                    </li>
                </ul>
            </aside>

            <!-- <aside class="lms-sidebar">
                <div class="lms-logo">ðŸšš Logistics Management</div>

                <ul class="lms-menu">
                    <li t-on-click="() => setActiveSection('dashboard')" t-att-class="{'active': state.tab === 'dashboard'}">
                        Dashboard Overview
                    </li>

                    <li t-on-click="() => setActiveSection('lead')" t-att-class="{'active': state.tab === 'lead'}">
                        Lead Management
                    </li>

                    <li t-on-click="() => setActiveSection('warehouse')" t-att-class="{'active': state.tab === 'warehouse'}">
                        Warehouse Management
                    </li>

                    <li>
                        <div t-on-click="() => toggleSubMenu('dispatch')" class="menu-header">
                            <span>Dispatch Management</span>
                            <span class="arrow" t-esc="state.expanded.dispatch ? 'â–¾' : 'â–¸'"/>
                        </div>
                        <ul t-if="state.expanded.dispatch" class="submenu">
                            <li t-on-click="() => setActiveSection('trip_sheet')">Trip Sheet</li>
                            <li t-on-click="() => setActiveSection('route_dispatch')">Route Dispatch</li>
                            <li t-on-click="() => setActiveSection('lr')">Lorry Receipt (LR)</li>
                            <li t-on-click="() => setActiveSection('pod')">Proof of Delivery (POD)</li>
                            <li t-on-click="() => setActiveSection('ewaybill')">E-Way Bill</li>
                        </ul>
                    </li>

                    <li>
                        <div t-on-click="() => toggleSubMenu('operations')" class="menu-header">
                            <span>Logistics Operations</span>
                            <span class="arrow" t-esc="state.expanded.operations ? 'â–¾' : 'â–¸'"/>
                        </div>
                        <ul t-if="state.expanded.operations" class="submenu">
                            <li t-on-click="() => setActiveSection('fleet_overview')">Fleet Overview</li>
                            <li t-on-click="() => setActiveSection('vehicle_costs')">Vehicle Costs</li>
                            <li t-on-click="() => setActiveSection('odoometer')">Odometer</li>
                            <li t-on-click="() => setActiveSection('route_optimization')">Route Optimization</li>
                        </ul>
                    </li>

                    <li>
                        <div t-on-click="() => toggleSubMenu('finance')" class="menu-header">
                            <span>Finance &amp; Accounting</span>
                            <span class="arrow" t-esc="state.expanded.finance ? 'â–¾' : 'â–¸'"/>
                        </div>
                        <ul t-if="state.expanded.finance" class="submenu">
                            <li t-on-click="() => setActiveSection('finance_overview')">Overview</li>
                            <li t-on-click="() => setActiveSection('customer_invoices')">Customer Invoices</li>
                            <li t-on-click="() => setActiveSection('customer_credit_notes')">Customer Credit Notes</li>
                            <li t-on-click="() => setActiveSection('customer_payments')">Customer Payments</li>
                            <li t-on-click="() => setActiveSection('accounting_journals')">Accounting Journals</li>
                            <li t-on-click="() => setActiveSection('accounting_journals_entries')">Journal Entries</li>
                            <li t-on-click="() => setActiveSection('vendor_payments')">Bills</li>
                        </ul>
                    </li>

                    <li t-on-click="() => setActiveSection('rfq')" t-att-class="{'active': state.tab === 'rfq'}">
                        RFP/RFQ
                    </li>

                    <li>
                        <div t-on-click="() => toggleSubMenu('reporting')" class="menu-header">
                            <span>Reporting</span>
                            <span class="arrow" t-esc="state.expanded.reporting ? 'â–¾' : 'â–¸'"/>
                        </div>
                        <ul t-if="state.expanded.reporting" class="submenu">
                            <li>
                                <div t-on-click="() => toggleSubMenu('sales_reporting')" class="menu-header submenu-header">
                                    <span>Sales</span>
                                    <span class="arrow" t-esc="state.expanded.sales_reporting ? 'â–¾' : 'â–¸'"/>
                                </div>
                                <ul t-if="state.expanded.sales_reporting" class="submenu nested">
                                    <li t-on-click="() => setActiveSection('sales')">Lead Sales</li>
                                    <li t-on-click="() => setActiveSection('sales_persons')">Sales Persons</li>
                                    <li t-on-click="() => setActiveSection('sales_products')">Products</li>
                                </ul>
                            </li>

                            <li>
                                <div t-on-click="() => toggleSubMenu('inventory_warehouse_reporting')" class="menu-header submenu-header">
                                    <span>Inventory &amp; Warehouse</span>
                                    <span class="arrow" t-esc="state.expanded.inventory_warehouse_reporting ? 'â–¾' : 'â–¸'"/>
                                </div>
                                <ul t-if="state.expanded.inventory_warehouse_reporting" class="submenu nested">
                                    <li t-on-click="() => setActiveSection('overview')">Overview</li>
                                    <li t-on-click="() => setActiveSection('warehouse_analysis')">Warehouse Analysis</li>
                                </ul>
                            </li>
                        </ul>
                    </li>


                    <li t-on-click="() => setActiveSection('contract')" t-att-class="{'active': state.tab === 'contract'}">
                        Contract Management
                    </li>
                </ul>
            </aside> -->

            <!-- Main Content -->
            <main class="lms-main">
                <!-- Dashboard View with Stats -->
                <t t-if="state.tab === 'dashboard'">
                    <div class="dashboard-content">
                        <div class="dashboard-header">
                            <h1>Logistics Management Dashboard</h1>
                        </div>

                        <!-- Loading State -->
                        <t t-if="state.loading">
                            <div class="loading-container">
                                <div class="spinner"></div>
                                <p>Loading dashboard statistics...</p>
                            </div>
                        </t>

                        <!-- Stats Grid -->
                        <t t-else="">
                            <div class="stats-grid">

                                <!-- CRM Stats -->
                                <div class="stat-card crm-card" t-on-click="() => navigateTo('lead')">
                                    <div class="stat-header">
                                        <h3>Lead Management</h3>
                                        <span class="stat-icon">ðŸ“Š</span>
                                    </div>
                                    <div class="stat-body">
                                        <div class="stat-main">
                                            <div class="stat-number" t-esc="state.stats.leads.total"/>
                                            <div class="stat-label">Total Leads</div>
                                        </div>
                                        <div class="stat-details">
                                            <div class="stat-item success">
                                                <span class="value" t-esc="state.stats.leads.won"/>
                                                <span class="label">Won</span>
                                            </div>
                                            <div class="stat-item warning">
                                                <span class="value" t-esc="state.stats.leads.in_progress"/>
                                                <span class="label">In Progress</span>
                                            </div>
                                            <div class="stat-item danger">
                                                <span class="value" t-esc="state.stats.leads.lost"/>
                                                <span class="label">Lost</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Warehouse Stats -->
                                <div class="stat-card warehouse-card" t-on-click="() => navigateTo('warehouse')">
                                    <div class="stat-header">
                                        <h3>Warehouse Management</h3>
                                        <span class="stat-icon">ðŸ“¦</span>
                                    </div>
                                    <div class="stat-body">
                                        <div class="stat-main">
                                            <div class="stat-number" t-esc="state.stats.warehouse.total_products"/>
                                            <div class="stat-label">Total Products</div>
                                        </div>
                                        <div class="stat-details">
                                            <div class="stat-item">
                                                <span class="value" t-esc="formatCurrency(state.stats.warehouse.stock_value)"/>
                                                <span class="label">Stock Value</span>
                                            </div>
                                            <div class="stat-item warning">
                                                <span class="value" t-esc="state.stats.warehouse.pending_transfers"/>
                                                <span class="label">Pending Transfers</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Dispatch Stats -->
                                <div class="stat-card dispatch-card" t-on-click="() => navigateTo('trip_sheet')">
                                    <div class="stat-header">
                                        <h3>Dispatch Management</h3>
                                        <span class="stat-icon">ðŸšš</span>
                                    </div>
                                    <div class="stat-body">
                                        <div class="stat-main">
                                            <div class="stat-number" t-esc="state.stats.dispatch.active_trips"/>
                                            <div class="stat-label">Active Trips</div>
                                        </div>
                                        <div class="stat-details">
                                            <div class="stat-item warning">
                                                <span class="value" t-esc="state.stats.dispatch.pending_lr"/>
                                                <span class="label">Pending LR</span>
                                            </div>
                                            <div class="stat-item warning">
                                                <span class="value" t-esc="state.stats.dispatch.pending_pod"/>
                                                <span class="label">Pending POD</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Fleet Stats -->
                                <div class="stat-card fleet-card" t-on-click="() => navigateTo('fleet_overview')">
                                    <div class="stat-header">
                                        <h3>Fleet Management</h3>
                                        <span class="stat-icon">ðŸš—</span>
                                    </div>
                                    <div class="stat-body">
                                        <div class="stat-main">
                                            <div class="stat-number" t-esc="state.stats.fleet.total_vehicles"/>
                                            <div class="stat-label">Total Vehicles</div>
                                        </div>
                                        <div class="stat-details">
                                            <div class="stat-item success">
                                                <span class="value" t-esc="state.stats.fleet.active_vehicles"/>
                                                <span class="label">Active</span>
                                            </div>
                                            <!-- <div class="stat-item danger">
                                                <span class="value" t-esc="state.stats.fleet.maintenance_due"/>
                                                <span class="label">Maintenance Due</span>
                                            </div> -->
                                        </div>
                                    </div>
                                </div>

                                <!-- Finance Stats -->
                                <div class="stat-card finance-card" t-on-click="() => navigateTo('finance_overview')">
                                    <div class="stat-header">
                                        <h3>Finance &amp; Accounting</h3>
                                        <span class="stat-icon">ðŸ’°</span>
                                    </div>
                                    <div class="stat-body">
                                        <div class="stat-main">
                                            <div class="stat-number" t-esc="formatCurrency(state.stats.finance.unpaid_amount)"/>
                                            <div class="stat-label">Unpaid Amount</div>
                                        </div>
                                        <div class="stat-details">
                                            <div class="stat-item warning">
                                                <span class="value" t-esc="state.stats.finance.unpaid_invoices"/>
                                                <span class="label">Unpaid Invoices</span>
                                            </div>
                                            <div class="stat-item warning">
                                                <span class="value" t-esc="state.stats.finance.pending_bills"/>
                                                <span class="label">Pending Bills</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- RFQ Stats -->
                                <div class="stat-card rfq-card" t-on-click="() => navigateTo('rfq')">
                                    <div class="stat-header">
                                        <h3>RFP/RFQ</h3>
                                        <span class="stat-icon">ðŸ“‹</span>
                                    </div>
                                    <div class="stat-body">
                                        <div class="stat-main">
                                            <div class="stat-label">Quick Access</div>
                                        </div>
                                        <div class="stat-details">
                                            <div class="stat-item">
                                                <span class="label">Manage RFQs â†’</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <!-- Quick Actions -->
                            <!-- <div class="quick-actions">
                                <h2>Quick Actions</h2>
                                <div class="actions-grid">
                                    <button class="action-btn" t-on-click="() => navigateTo('lead')">
                                        <span class="btn-icon">âž•</span>
                                        <span>New Lead</span>
                                    </button>
                                    <button class="action-btn" t-on-click="() => navigateTo('trip_sheet')">
                                        <span class="btn-icon">ðŸšš</span>
                                        <span>Create Trip Sheet</span>
                                    </button>
                                    <button class="action-btn" t-on-click="() => navigateTo('customer_invoices')">
                                        <span class="btn-icon">ðŸ“„</span>
                                        <span>New Invoice</span>
                                    </button>
                                    <button class="action-btn" t-on-click="() => navigateTo('rfq')">
                                        <span class="btn-icon">ðŸ“‹</span>
                                        <span>New RFQ</span>
                                    </button>
                                </div>
                            </div> -->
                        </t>
                    </div>
                </t>

                <!-- Iframe View for other sections -->
                <t t-if="state.tab !== 'dashboard' and state.iframeSrc">
                    <div class="iframe-container">
                        <iframe t-key="state.iframeKey" t-att-src="state.iframeSrc" frameborder="0"/>
                    </div>
                </t>

                <!-- Welcome Message -->
                <t t-if="state.tab !== 'dashboard' and !state.iframeSrc">
                    <div class="welcome-container">
                        <p>ðŸ‘‹ Welcome â€” Select a module from the sidebar to begin.</p>
                    </div>
                </t>
            </main>
        </div>
    </t>
</templates>

